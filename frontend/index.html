<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>AWE2</title>

    <link href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" rel="stylesheet"
          integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg=="
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
</head>

<body>

<div>
    <canvas height="600" id="chartTemperature" width="1000"></canvas>
    <canvas height="600" id="chartAirPressure" width="1000"></canvas>
    <canvas height="600" id="chartHumidity" width="1000"></canvas>
</div>

<script>

  let chartTemperature = document.getElementById('chartTemperature').getContext('2d');
  let chartAirPressure = document.getElementById('chartAirPressure').getContext('2d');
  let chartHumidity = document.getElementById('chartHumidity').getContext('2d');

  function createChart(chartTemperature, data, values, timestamps, label, color) {
    new Chart(chartTemperature, {
      type: 'line',
      data: {
        labels: timestamps,
        datasets: [{
          label: label,
          data: values,
          backgroundColor: color,
        }],
      },
    });
  }

  $.get('https://awe2-api.jeujeus.de/weatherData', function(data, status) {

    //TODO REMOVE ME FOR SHOWCASE ONLY
    console.log(data.sensorData);

    let theBeginning = data.sensorData[0].TIMESTAMP;
    let timestamps = data.sensorData.map(function(e) {
      return e.TIMESTAMP - theBeginning;
    });

    let temperature = data.sensorData.map(function(e) {
      return e.TEMPERATURE;
    });

    let airPressure = data.sensorData.map(function(e) {
      return e.AIRPRESSURE;
    });

    let humidity = data.sensorData.map(function(e) {
      return e.HUMIDITY;
    });

    createChart(chartTemperature, data, temperature, timestamps, 'Temperature', 'rgba(0, 119, 204, 0.3)');
    createChart(chartAirPressure, data, airPressure, timestamps, 'Air Pressure', 'rgb(0,204,109)');
    createChart(chartHumidity, data, humidity, timestamps, 'Humidity', 'rgb(204,0,112)');

  });
</script>
</body>

</html>
