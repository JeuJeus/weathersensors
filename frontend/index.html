<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>AWE2</title>

    <link href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" rel="stylesheet"
          integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg=="
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
</head>

<body>

<div>
    <canvas height="600" id="chartTemperature" width="1000"></canvas>
    <canvas height="600" id="chartAirPressure" width="1000"></canvas>
    <canvas height="600" id="chartHumidity" width="1000"></canvas>
</div>

<script>

  let chartTemperature = document.getElementById('chartTemperature').getContext('2d');
  let chartAirPressure = document.getElementById('chartAirPressure').getContext('2d');
  let chartHumidity = document.getElementById('chartHumidity').getContext('2d');

  function createTemperatureChart(data, timestamps) {
    let temperatures = data.sensorData.map(function(e) {
      return e.TEMPERATURE;
    });

    new Chart(chartTemperature, {
      type: 'line',
      data: {
        labels: timestamps,
        datasets: [{
          label: 'Temperature',
          data: temperatures,
          backgroundColor: 'rgba(0, 119, 204, 0.3)',
        }],
      },
    });
  }

  function createAirPressureChart(data, timestamps) {
    let airPressure = data.sensorData.map(function(e) {
      return e.AIRPRESSURE;
    });

    new Chart(chartAirPressure, {
      type: 'line',
      data: {
        labels: timestamps,
        datasets: [{
          label: 'Air Pressure',
          data: airPressure,
          backgroundColor: 'rgb(0,204,109)',
        }],
      },
    });
  }

  function createHumidityChart(data, timestamps) {
    let humidity = data.sensorData.map(function(e) {
      return e.HUMIDITY;
    });

    new Chart(chartHumidity, {
      type: 'line',
      data: {
        labels: timestamps,
        datasets: [{
          label: 'Humidity',
          data: humidity,
          backgroundColor: 'rgb(204,0,112)',
        }],
      },
    });
  }

  $.get('https://awe2-api.jeujeus.de/weatherData', function(data, status) {

    //REMOVE ME FOR SHOWCASE ONLY
    console.log(data.sensorData);

    let theBeginning = data.sensorData[0].TIMESTAMP;
    let timestamps = data.sensorData.map(function(e) {
      return e.TIMESTAMP - theBeginning;
    });

    createTemperatureChart(data, timestamps);
    createAirPressureChart(data, timestamps);
    createHumidityChart(data, timestamps);

  });
</script>
</body>

</html>
